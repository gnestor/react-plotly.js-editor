{"version":3,"sources":["../../src/lib/dereference.js"],"names":["dereference","SRC_ATTR_PATTERN","container","dataSources","replacer","key","parent","test","srcRef","data","Array","isArray","dataKey","replace","walkArraysMatchingKeys"],"mappings":";;;;;kBAIwBA,W;;AAJxB;;;;;;AAEA,IAAMC,mBAAmB,MAAzB;;AAEe,SAASD,WAAT,CAAqBE,SAArB,EAAgCC,WAAhC,EAA6C;AAC1D,MAAMC,WAAW,SAAXA,QAAW,CAACC,GAAD,EAAMC,MAAN,EAAiB;AAChC,QAAI,CAACL,iBAAiBM,IAAjB,CAAsBF,GAAtB,CAAL,EAAiC;AAC/B;AACD;;AAED,QAAMG,SAASF,OAAOD,GAAP,CAAf;AACA,QAAMI,OAAON,YAAYK,MAAZ,CAAb;;AAEA,QAAI,CAACE,MAAMC,OAAN,CAAcF,IAAd,CAAL,EAA0B;AACxB;AACD;;AAED,QAAMG,UAAUP,IAAIQ,OAAJ,CAAYZ,gBAAZ,EAA8B,EAA9B,CAAhB;AACAK,WAAOM,OAAP,IAAkBH,IAAlB;AACD,GAdD;;AAgBA,4BAAWP,SAAX,EAAsBE,QAAtB,EAAgC;AAC9BU,4BAAwB,CAAC,MAAD,EAAS,YAAT;AADM,GAAhC;AAGD","file":"dereference.js","sourcesContent":["import walkObject from './walkObject';\n\nconst SRC_ATTR_PATTERN = /src$/;\n\nexport default function dereference(container, dataSources) {\n  const replacer = (key, parent) => {\n    if (!SRC_ATTR_PATTERN.test(key)) {\n      return;\n    }\n\n    const srcRef = parent[key];\n    const data = dataSources[srcRef];\n\n    if (!Array.isArray(data)) {\n      return;\n    }\n\n    const dataKey = key.replace(SRC_ATTR_PATTERN, '');\n    parent[dataKey] = data;\n  };\n\n  walkObject(container, replacer, {\n    walkArraysMatchingKeys: ['data', 'transforms'],\n  });\n}\n"]}